library(readr)
library(lubridate)
library(tidyverse)

## Read in Data

Raw_Obs_Paipote <- read_csv("ENAMI/Observados/Enero/RAW_S001T01_202202030703.csv")

Raw_Obs_Copiapo <- read_csv("ENAMI/Observados/Enero/RAW_S002T01_202202030703.csv")

Raw_Obs_SanFdo <- read_csv("ENAMI/Observados/Enero/RAW_S003T01_202202030704.csv")

Raw_Obs_TierraAmarilla <- read_csv("ENAMI/Observados/Enero/RAW_S004T01_202202030704.csv")

Raw_Obs_Volcanes <- read_csv("ENAMI/Observados/Enero/RAW_S005T01_202202030704.csv")


## Reduce Data

Obs_Paipote <- Raw_Obs_Paipote[c(1,4)]

Obs_Copiapo <- Raw_Obs_Copiapo[c(1,4)]

Obs_SanFdo <- Raw_Obs_SanFdo[c(1,4)]

Obs_TierraAmarilla <- Raw_Obs_TierraAmarilla[c(1,4)]

Obs_Volcanes <- Raw_Obs_Volcanes[c(1,4)]

## Delete Rows with -9999

Obs_Paipote <- subset(Obs_Paipote, Value2 != -9999)

Obs_Copiapo <- subset(Obs_Copiapo, Value2 != -9999)

Obs_SanFdo <- subset(Obs_SanFdo, Value2 != -9999)

Obs_TierraAmarilla <- subset(Obs_TierraAmarilla, Value2 != -9999)

Obs_Volcanes <- subset(Obs_Volcanes, Value2 != -9999)

## Delete Negative Rows

Obs_Paipote <- subset(Obs_Paipote, Value2 > 0)

Obs_Copiapo <- subset(Obs_Copiapo, Value2 > 0)

Obs_SanFdo <- subset(Obs_SanFdo, Value2 > 0)

Obs_TierraAmarilla <- subset(Obs_TierraAmarilla, Value2 > 0)

Obs_Volcanes <- subset(Obs_Volcanes, Value2 > 0)


## Wrangle


Avg_Obs_Paipote <- Obs_Paipote %>% 
  mutate(Hora = hour(Date_Time),
         Dia = day(Date_Time))

#check if the code below is necessary (it most likely wont be)
#Avg_Obs_Paipote$Hora[5761:5820] <- 0

Avg_Obs_Paipote <- Avg_Obs_Paipote %>%
  group_by(Dia, Hora) %>% 
  summarise(PromedioHorario = mean(Value2))


Avg_Obs_Copiapo <- Obs_Copiapo %>% 
  mutate(Hora = hour(Date_Time),
         Dia = day(Date_Time))

#check if the code below is necessary (it most likely wont be)
#Avg_Obs_Copiapo$Hora[5761:5820] <- 0

Avg_Obs_Copiapo <- Avg_Obs_Copiapo %>% 
  group_by(Dia, Hora) %>% 
  summarise(PromedioHorario = mean(Value2))


Avg_Obs_SanFdo <- Obs_SanFdo %>% 
  mutate(Hora = hour(Date_Time),
         Dia = day(Date_Time))
#check if the code below is necessary (it most likely wont be)
#Avg_Obs_SanFdo$Hora[5750:5809] <- 0

Avg_Obs_SanFdo <- Avg_Obs_SanFdo %>% 
  group_by(Dia, Hora) %>% 
  summarise(PromedioHorario = mean(Value2))


Avg_Obs_TierraAmarilla <- Obs_TierraAmarilla %>% 
  mutate(Hora = hour(Date_Time),
         Dia = day(Date_Time))

#check if the code below is necessary (it most likely wont be)
#Avg_Obs_TierraAmarilla$Hora[5761:5820] <- 0

Avg_Obs_TierraAmarilla <- Avg_Obs_TierraAmarilla %>%
  group_by(Dia, Hora) %>% 
  summarise(PromedioHorario = mean(Value2))


Avg_Obs_Volcanes <- Obs_Volcanes %>% 
  mutate(Hora = hour(Date_Time),
         Dia = day(Date_Time))

#check if the code below is necessary (it most likely wont be)
#Avg_Obs_Volcanes$Hora[5761:5820] <- 0

Avg_Obs_Volcanes <- Avg_Obs_Volcanes %>% 
  group_by(Dia, Hora) %>% 
  summarise(PromedioHorario = mean(Value2))


## exportar

write.csv(Avg_Obs_Paipote, file = "ENAMI/Observados/Enero/Limpios/Paipote_Obs.csv")

write.csv(Avg_Obs_Copiapo, file = "ENAMI/Observados/Enero/Limpios/Copiapo_Obs.csv")

write.csv(Avg_Obs_SanFdo, file = "ENAMI/Observados/Enero/Limpios/SanFdo_Obs.csv")

write.csv(Avg_Obs_TierraAmarilla, file = "ENAMI/Observados/Enero/Limpios/TierraAmarilla_Obs.csv")

write.csv(Avg_Obs_Volcanes, file = "ENAMI/Observados/Enero/Limpios/Volcanes_Obs.csv")




















































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































