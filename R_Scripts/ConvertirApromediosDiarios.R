library(readr)
library(lubridate)
library(tidyverse)

## Read in Data

Raw_Obs_Paipote <- read_csv("ENAMI/Observados/Febrero/Paipote.csv")

Raw_Obs_Copiapo <- read_csv("ENAMI/Observados/Febrero/Copiapo.csv")

Raw_Obs_SanFdo <- read_csv("ENAMI/Observados/Febrero/SanFdo.csv")

Raw_Obs_TierraAmarilla <- read_csv("ENAMI/Observados/Febrero/TierraAmarilla.csv")

Raw_Obs_Principal <- read_csv("ENAMI/Observados/Febrero/Principal.csv")


## Reduce Data

Obs_Paipote <- Raw_Obs_Paipote[c(1,6,8)]

Obs_Copiapo <- Raw_Obs_Copiapo[c(1,6,8)]

Obs_SanFdo <- Raw_Obs_SanFdo[c(1,6,8)]

Obs_TierraAmarilla <- Raw_Obs_TierraAmarilla[c(1,6,8)]

Obs_Principal <- Raw_Obs_Principal[c(1,2,4,6,8,10,12,14)]

## Delete Rows with -9999

Obs_Paipote <- subset(Obs_Paipote, Value3 != -9999 & Value4 != -9999)

Obs_Copiapo <- subset(Obs_Copiapo, Value3 != -9999 & Value4 != -9999)

Obs_SanFdo <- subset(Obs_SanFdo, Value3 != -9999 & Value4 != -9999)

Obs_TierraAmarilla <- subset(Obs_TierraAmarilla, Value3 != -9999 & Value4 != -9999)

Obs_Principal <- subset(Obs_Principal, Value1 != -9999 & Value2 != -9999 & Value3 != -9999 & Value4 != -9999 & Value5 != -9999 & Value6 != -9999 & Value7 != -9999)

## Delete Negative Rows

Obs_Paipote <- subset(Obs_Paipote, Value3 >= 0 & Value4 >= 0)

Obs_Copiapo <- subset(Obs_Copiapo, Value3 >= 0 & Value4 >= 0)

Obs_SanFdo <- subset(Obs_SanFdo, Value3 >= 0 & Value4 >= 0)

Obs_TierraAmarilla <- subset(Obs_TierraAmarilla, Value3 >= 0 & Value4 >= 0)

Obs_Principal <- subset(Obs_Principal, Value1 >= 0 & Value2 >= 0 & Value3 >= 0 & Value4 >= 0 & Value5 >= 0 & Value6 >= 0 & Value7 >= 0)


## Wrangle


Avg_Obs_Paipote <- Obs_Paipote %>% 
  mutate(Hora = hour(Date_Time),
         Dia = day(Date_Time))

#check if the code below is necessary (it most likely wont be)
#Avg_Obs_Paipote$Hora[5761:5820] <- 0

Avg_Obs_Paipote <- Avg_Obs_Paipote %>%
  group_by(Dia, Hora) %>% 
  summarise(VV = mean(Value3), DV = mean(Value4))


Avg_Obs_Copiapo <- Obs_Copiapo %>% 
  mutate(Hora = hour(Date_Time),
         Dia = day(Date_Time))

#check if the code below is necessary (it most likely wont be)
#Avg_Obs_Copiapo$Hora[5761:5820] <- 0

Avg_Obs_Copiapo <- Avg_Obs_Copiapo %>% 
  group_by(Dia, Hora) %>% 
  summarise(VV = mean(Value3), DV = mean(Value4))


Avg_Obs_SanFdo <- Obs_SanFdo %>% 
  mutate(Hora = hour(Date_Time),
         Dia = day(Date_Time))
#check if the code below is necessary (it most likely wont be)
#Avg_Obs_SanFdo$Hora[5750:5809] <- 0

Avg_Obs_SanFdo <- Avg_Obs_SanFdo %>% 
  group_by(Dia, Hora) %>% 
  summarise(VV = mean(Value3), DV = mean(Value4))


Avg_Obs_TierraAmarilla <- Obs_TierraAmarilla %>% 
  mutate(Hora = hour(Date_Time),
         Dia = day(Date_Time))

#check if the code below is necessary (it most likely wont be)
#Avg_Obs_TierraAmarilla$Hora[5761:5820] <- 0

Avg_Obs_TierraAmarilla <- Avg_Obs_TierraAmarilla %>%
  group_by(Dia, Hora) %>% 
  summarise(VV = mean(Value3), DV = mean(Value4))


Avg_Obs_Principal <- Obs_Principal %>% 
  mutate(Hora = hour(Date_Time),
         Dia = day(Date_Time))

#check if the code below is necessary (it most likely wont be)
#Avg_Obs_Volcanes$Hora[5761:5820] <- 0

Avg_Obs_Principal <- Avg_Obs_Principal %>% 
  group_by(Dia, Hora) %>% 
  summarise(VV = mean(Value1), DV = mean(Value2), Temp = mean(Value3), AMB_PRES = mean(Value4), HR = mean(Value5), PREC = mean(Value6), RS = mean(Value7))


## exportar

write.csv(Avg_Obs_Paipote, file = "ENAMI/Observados/September/Datos_Limpios/Met_Paipote_Obs.csv")

write.csv(Avg_Obs_Copiapo, file = "ENAMI/Observados/September/Datos_Limpios/Met_Copiapo_Obs.csv")

write.csv(Avg_Obs_SanFdo, file = "ENAMI/Observados/September/Datos_Limpios/Met_SanFdo_Obs.csv")

write.csv(Avg_Obs_TierraAmarilla, file = "ENAMI/Observados/September/Datos_Limpios/Met_TierraAmarilla_Obs.csv")

write.csv(Avg_Obs_Principal, file = "ENAMI/Observados/September/Datos_Limpios/Met_Principal_Obs.csv")




















































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































